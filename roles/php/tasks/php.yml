---
- name: PHP | Add php-7.3 PPA
  yum: name=epel-release state=present
  become: yes

- name: PHP | install php packages
  yum:
    name:
      [
        'php73-fpm',
        'php73-cli',
        'php73-common',
        'php73-curl',
        'php73-json',
        'php73-gd',
        # 'php73-mcrypt',
        'php73-odbc',
        'php73-pgsql',
        'php73-mbstring',
        'php73-mysql',
        'php73-xmlrpc',
        'php73-opcache',
        'php73-intl',
        'php73-bz2',
        'php73-xml'
      ]
    state: installed
  become: yes

# - name: PHP | FPM php.ini
#   template:
#     src=php.ini.j2
#     dest=/etc/php/7.0/fpm/php.ini
#     backup=yes
#     owner=root
#     group=root
#     mode=0644
#   become: yes

# - name: PHP | CLI php.ini
#   template:
#     src=php.ini.j2
#     dest=/etc/php/7.0/cli/php.ini
#     backup=yes
#     owner=root
#     group=root
#     mode=0644
#   become: yes

# - name: PHP | configure opcache
#   template:
#     src=opcache.ini.j2
#     dest=/etc/php/7.0/mods-available/opcache.ini
#     backup=yes
#     owner=root
#     group=root
#     mode=0644
#   become: yes

- name: PHP | restart nginx
  raw: service nginx restart
  become: yes

- name: PHP | restart fpm
  raw: service php73-fpm restart
  become: yes
